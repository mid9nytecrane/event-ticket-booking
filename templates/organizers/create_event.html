{% extends "core/base.html" %}
{% block content %}

<div class="max-w-3xl mx-auto mt-24 px-4 py-10 bg-white shadow-lg rounded-xl">
    <a href="{% url 'organizers:creator-dashboard'%}" 
        class="flex  items-center gap-2 mb-2 bg-gray-100 w-20 px-2 py-1 shadow-lg rounded-full hover:bg-gray-200">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
    <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-4.28 9.22a.75.75 0 0 0 0 1.06l3 3a.75.75 0 1 0 1.06-1.06l-1.72-1.72h5.69a.75.75 0 0 0 0-1.5h-5.69l1.72-1.72a.75.75 0 0 0-1.06-1.06l-3 3Z" clip-rule="evenodd" />
    </svg>

        back
    </a>
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">
        Create a New Event
    </h1>

    <form 
        x-data="{ preview: null, submitting: false }"
        method="post" 
        enctype="multipart/form-data"
        class="space-y-6"
        @submit="submitting = true"
    >
        {% csrf_token %}


        <!-- Title -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Event Title</label>
            {{form.title}}
            {% for field in form %}
                {% if field.errors %}
                    <p class="text-red-500 text-sm mt-1">{{field.errors.0}}</p>
                {% endif %}
            {% endfor %}
        </div>

        <!--Event Category-->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Event Category</label>
            {{form.category}}
        </div>


        <!-- Date -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Event Date</label>
            {{form.date}}
        </div>

        <!-- Location -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Location</label>
            {{form.location}}
            {% for field in form %}
                {% if field.errors %}
                    <p class="text-red-500 text-sm mt-1">{{field.errors.0}}</p>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Organizer-->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Organizer</label>
            {{form.organizer}}
            {% for field in form %}
                {% if field.errors %}
                    <p class="text-red-500 text-sm mt-1">{{field.errors}}</p>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Category -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Category</label>
            {{form.event_tag}}
        </div>

        <!-- Price -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Price (GHS)</label>
            {{form.price}}
        </div>

        <!-- total tickets -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Total Tickets</label>
            {{form.total_tickets}}
        </div>

        <!-- Description -->
        <div>
            <label class="block text-gray-700 font-semibold mb-1">Description</label>
            {{form.description}}
        </div>

        <!-- Banner Upload with Preview -->
        <div>
            <label class="block text-gray-700 font-semibold">Event Banner</label>

            <input 
                type="file"
                name="banner"
                @change="preview = URL.createObjectURL($event.target.files[0])"
                class="mt-2 block text-gray-700 border border-gray-300 rounded-lg w-full"
            >

            <template x-if="preview">
                <img 
                    :src="preview" 
                    class="mt-3 w-full h-56 object-cover rounded-lg border border-gray-300 shadow"
                >
            </template>
        </div> 

        {% comment %} <div>
            {{form.banner}}
        </div> {% endcomment %}

        <!-- Submit Button -->
        <button 
            type="submit"
            :disabled="submitting"
            :class="{ 'opacity-50 cursor-not-allowed': submitting }"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg text-lg shadow-md transition disabled:hover:bg-blue-600"
        >
            <span x-show="!submitting">Submit Event</span>
            <span x-show="submitting" class="flex items-center justify-center gap-2">
                <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Creating Event...
            </span>
        </button>

    </form>
</div>


<script>
document.addEventListener("DOMContentLoaded", function () {
    flatpickr(".datepicker", {
        dateFormat: "Y-m-d",
        minDate: "today",
    });
});
</script>

{% endblock content %}
