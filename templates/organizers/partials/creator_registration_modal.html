<dialog id="registration_form" class="modal">
    <div class="modal-box">
        <div 
            x-data="{
                step: 1,
                check: false,
                isLeaving: false,
                nextStep: null
            }" 
            x-init="$watch('step', (value, oldValue) => {
                if (oldValue) {
                    isLeaving = true;
                    setTimeout(() => {
                        isLeaving = false;
                    }, 200);
                }
            })"
            class="mt-10">

            <!-- Title -->
            <div class="flex justify-between items-center pb-3">
                <h3 class="text-lg font-semibold">
                    <template x-if="step === 1">Creator Registration</template>
                    <template x-if="step === 2">Platform Policy</template>
                    <template x-if="step === 3">Confirm & Submit</template>
                </h3>
            </div>

            <form method="POST" class="space-y-5">
                {% csrf_token %}
                <!-- message -->
                {% if messages %}
                    {% for message in messages %}
                        <div class="mb-4 p-4 rounded-lg {% if message.tags == 'success' %}bg-green-100 text-green-800{% elif message.tags == 'error' %}bg-red-100 text-red-800{% else %}bg-blue-100 text-blue-800{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
                <h3 class="text-2xl font-bold text-gray-900">Register as Event Creator</h3>
                
                <!-- Container for all steps - REMOVED absolute positioning -->
                <div class="relative overflow-hidden min-h-[450px]">
                    <!-- ---------------- STEP 1 ---------------- -->
                    <div 
                        x-show="step === 1" 
                        x-transition:enter="transition ease-out duration-300"
                        x-transition:enter-start="opacity-0 translate-x-10"
                        x-transition:enter-end="opacity-100 translate-x-0"
                        x-transition:leave="transition ease-in duration-200"
                        x-transition:leave-start="opacity-100 translate-x-0"
                        x-transition:leave-end="opacity-0 -translate-x-10"
                        class="w-full transition-all duration-300"
                        x-cloak
                        >
                        <div class="space-y-4">
                            <div class="flex items-center mb-6">
                                <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold mr-3">
                                    1
                                </div>
                                <h4 class="text-lg font-semibold text-black">Mobile Money Details</h4>
                            </div>
                            <p class="text-gray-500 mb-3 text-sm">
                                Provide your payout & identity details to receive event earnings. <br>
                                Provide your mobile money number for receiving payments. <br> Add country code(+233) to the number,
                                e.g +233244123456
                            </p>
                            
                            <div>
                                <label class="text-sm text-gray-700 font-medium">Mobile Money Number</label>
                                <div class="mt-1">
                                    {{ form.momo_numb }}
                                    {% for field in form %}
                                        {% if field.errors %}
                                            <p class='text-red-500 text-sm mt-1 '>{{field.errors.0}}</p>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>

                            <div>
                                <label class="text-sm text-gray-700 font-medium">Name of Money Number</label>
                                <div class="mt-1">
                                    {{ form.full_name }}
                                    {% for field in form %}
                                        {% if field.errors %}
                                            <p class='text-red-500 text-sm mt-1 '>{{field.errors.0}}</p>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>

                            <div>
                                <label class="text-sm text-gray-700 font-medium">Email</label>
                                <div class="mt-1">
                                    {{ form.email }}
                                    {% for field in form %}
                                        {% if field.errors %}
                                            <p class='text-red-500 text-sm mt-1 '>{{field.errors.0}}</p>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>

                            <div class="flex justify-end mt-8">
                                <button @click="step = 2" type="button"
                                    class="px-5 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-500 transition-colors">
                                    Next ‚Üí
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ---------------- STEP 2 ---------------- -->
                    <div 
                        x-show="step === 2" 
                        x-transition:enter="transition ease-out duration-300"
                        x-transition:enter-start="opacity-0 translate-x-10"
                        x-transition:enter-end="opacity-100 translate-x-0"
                        x-transition:leave="transition ease-in duration-200"
                        x-transition:leave-start="opacity-100 translate-x-0"
                        x-transition:leave-end="opacity-0 -translate-x-10"
                        class="w-full transition-all duration-300"
                        x-cloak
                        >
                        <div class="space-y-4">
                            <div class="flex items-center mb-6">
                                <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold mr-3">
                                    2
                                </div>
                                <h4 class="text-lg font-semibold text-gray-800">Terms & Conditions</h4>
                            </div>
                            <p class="text-gray-700 mb-3 font-semibold">Before continuing:</p>
                    
                            <div class="bg-gray-50 shadow-md rounded-lg p-4 text-sm text-gray-600 space-y-2 overflow-y-auto max-h-60">
                                <h5 class="font-semibold text-gray-800 mb-3">Important Payment Terms:</h5>
                                <p>‚úî You will receive 95% of all ticket sales revenue</p>
                                <p>‚úî Your Momo number will be used to receive event ticket earnings.</p>
                                <p>‚úî If payment is delayed beyond 24 hours, you receive an additional 5% compensation.</p>
                                <p>‚úî A <b>5% platform fee</b> applies on every successful ticket sale.</p>
                                <p>‚úî You must provide valid event details and follow our community standards.</p>
                            </div>

                            <label class="flex items-center space-x-2 mt-6">
                                <input x-model="check" type="checkbox" required class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                                <span class="text-gray-700 text-sm">
                                    I have read and agree to the Event Creator Policies.
                                </span>
                            </label>

                            <div class="flex justify-between mt-8">
                                <button @click="step = 1" type="button"
                                    class="px-5 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 transition-colors">
                                    ‚Üê Back
                                </button>

                                <button @click="step = 3" type="button"
                                        :disabled="!check"
                                        :class="!check ? 'bg-gray-300 cursor-not-allowed hover:bg-gray-300' : 'bg-blue-600 hover:bg-blue-500'"
                                    class="px-5 py-2 rounded-md text-white transition-colors">
                                    Continue ‚Üí
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ---------------- STEP 3 ---------------- -->
                    <div 
                        x-show="step === 3" 
                        x-transition:enter="transition ease-out duration-300"
                        x-transition:enter-start="opacity-0 translate-x-10"
                        x-transition:enter-end="opacity-100 translate-x-0"
                        x-transition:leave="transition ease-in duration-200"
                        x-transition:leave-start="opacity-100 translate-x-0"
                        x-transition:leave-end="opacity-0 -translate-x-10"
                        class="w-full transition-all duration-300"
                        x-cloak
                        >
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">
                                You're almost there üéâ
                            </h4>

                            <p class="text-gray-600 text-sm mb-3">
                                By submitting, your account will be reviewed and upgraded to an event creator.
                                You'll be able to:
                            </p>

                            <ul class="text-sm text-gray-700 list-disc pl-6 space-y-2 mb-6">
                                <li>Create and manage events</li>
                                <li>Sell tickets and receive payments</li>
                                <li>Monitor attendee analytics</li>
                            </ul>

                            <div class="flex justify-between mt-8">
                                <button @click="step = 2" type="button"
                                    class="px-5 py-2 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors">
                                    ‚Üê Back
                                </button>

                                <button type="submit"
                                    class="px-6 py-2 rounded-md bg-green-600 text-white hover:bg-green-500 transition-colors">
                                    Submit & Register
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            
            <!-- Progress indicator -->
            <div class="mt-8">
                <div class="flex items-center justify-center space-x-2">
                    <template x-for="i in 3" :key="i">
                        <div 
                            :class="step === i ? 'bg-blue-600' : 'bg-gray-300'"
                            class="w-3 h-3 rounded-full transition-colors duration-300">
                        </div>
                    </template>
                </div>
            </div>
            
            <form method="dialog">
                <div class="modal-action">
                    <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-gray-800">‚úï</button>
                </div>
            </form>
        </div>
    </div>
</dialog>

<style>
[x-cloak] { display: none !important; }

/* Style the form inputs */
#registration_form input[type="text"],
#registration_form input[type="email"] {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    background-color: white;
    color: #374151;
    font-size: 0.875rem;
    line-height: 1.25rem;
    transition: all 0.2s;
}

#registration_form input[type="text"]:focus,
#registration_form input[type="email"]:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    background-color: white;
    color: #374151;
}

#registration_form input[type="text"]:hover,
#registration_form input[type="email"]:hover {
    border-color: #9ca3af;
}

/* Ensure text is visible */
#registration_form input {
    color: #374151 !important;
    background-color: white !important;
}
</style>